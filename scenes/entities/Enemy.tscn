[gd_scene load_steps=14 format=3 uid="uid://cnmwj8dlikh2o"]

[ext_resource type="Script" uid="uid://cob7ecgwsouqq" path="res://Source/entities/Enemy.cs" id="1_s7bn3"]
[ext_resource type="Material" uid="uid://bkma3afhynouv" path="res://Source/shaders/HitFlashShaderMaterial.tres" id="2_m80fk"]
[ext_resource type="SpriteFrames" uid="uid://ducvecsmuxhlm" path="res://assets/animations/worker/Worker.tres" id="3_m80fk"]
[ext_resource type="Script" uid="uid://codv2sgb45cwh" path="res://Entropek/Source/Characters/CharacterMovement.cs" id="5_306ko"]
[ext_resource type="PackedScene" uid="uid://ch4eus05salg0" path="res://Entropek/Source/ai/AiAttackHandler.tscn" id="6_mj3ic"]
[ext_resource type="Resource" uid="uid://75p11r0gk2cb" path="res://resources/ai/EnemyAttack.tres" id="7_8rhtt"]
[ext_resource type="PackedScene" uid="uid://qjsxrhg00wny" path="res://Entropek/scenes/Health.tscn" id="10_1jhey"]
[ext_resource type="Script" uid="uid://bkuua5ir5ybd6" path="res://Source/Wayfinding2D/WayfindingAgent2D.cs" id="10_m80fk"]
[ext_resource type="PackedScene" uid="uid://fyw1l5ue26s8" path="res://scenes/nodes/HitFlashShaderhController.tscn" id="12_v8ssa"]
[ext_resource type="Script" uid="uid://b60iyr5pp14vr" path="res://Source/nodes/HitBoxHandler.cs" id="13_qwpog"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tt7e2"]
size = Vector2(14, 14)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_qwpog"]
size = Vector2(18, 13)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_esdid"]
size = Vector2(13, 18)

[node name="Enemy" type="CharacterBody2D" node_paths=PackedStringArray("health", "navAgent", "characterMovement", "attackHandler", "hitBoxHandler", "hitFlash", "stunTimer", "ignoreEnemyTimer", "animator")]
material = ExtResource("2_m80fk")
collision_layer = 8
collision_mask = 14
script = ExtResource("1_s7bn3")
health = NodePath("Health")
navAgent = NodePath("Navigation2DAgent")
characterMovement = NodePath("CharacterMovement")
attackHandler = NodePath("AiAttackHandler")
hitBoxHandler = NodePath("HitBoxHandler")
hitFlash = NodePath("HitFlashShaderController")
stunTimer = NodePath("StunTimer")
ignoreEnemyTimer = NodePath("IgnoreEnemyTimer")
animator = NodePath("AnimatedSprite")

[node name="AnimatedSprite" type="AnimatedSprite2D" parent="."]
y_sort_enabled = true
material = ExtResource("2_m80fk")
scale = Vector2(0.125, 0.125)
sprite_frames = ExtResource("3_m80fk")
animation = &"AttackSide"
frame = 2
frame_progress = 0.593657
offset = Vector2(0, -45)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_tt7e2")

[node name="CharacterMovement" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("5_306ko")
character = NodePath("..")
BaseTopSpeed = 50.0
BaseAcceleration = 200.0
BaseDeceleration = 200.0

[node name="AiAttackHandler" parent="." node_paths=PackedStringArray("attackCooldowns", "hitBoxHandler") instance=ExtResource("6_mj3ic")]
upAttacks = Array[Resource]([ExtResource("7_8rhtt")])
rightAttacks = Array[Resource]([ExtResource("7_8rhtt")])
downAttacks = Array[Resource]([ExtResource("7_8rhtt")])
leftAttacks = Array[Resource]([ExtResource("7_8rhtt")])
omniAttacks = Array[Resource]([])
attackCooldowns = [NodePath("SlashCooldown")]
hitBoxHandler = NodePath("../HitBoxHandler")

[node name="SlashCooldown" type="Timer" parent="AiAttackHandler"]
one_shot = true

[node name="StunTimer" type="Timer" parent="."]
one_shot = true

[node name="IgnoreEnemyTimer" type="Timer" parent="."]

[node name="HitFlashShaderController" parent="." node_paths=PackedStringArray("sprite") instance=ExtResource("12_v8ssa")]
sprite = NodePath("../AnimatedSprite")

[node name="HitBoxHandler" type="Node2D" parent="." node_paths=PackedStringArray("hitBoxes", "timers")]
script = ExtResource("13_qwpog")
hitBoxes = [NodePath("SlashDown/CollisionShape2D"), NodePath("SlashLeft/CollisionShape2D2"), NodePath("SlashRight/CollisionShape2D"), NodePath("SlashUp/CollisionShape2D")]
timers = [NodePath("SlashDown/Timer"), NodePath("SlashLeft/Timer"), NodePath("SlashRight/Timer"), NodePath("SlashUp/Timer")]

[node name="SlashDown" type="Area2D" parent="HitBoxHandler"]
position = Vector2(0, 84)
scale = Vector2(1, 1.01132)
collision_layer = 0
collision_mask = 32

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitBoxHandler/SlashDown"]
position = Vector2(0, -70.2053)
shape = SubResource("RectangleShape2D_qwpog")
disabled = true

[node name="Timer" type="Timer" parent="HitBoxHandler/SlashDown"]
one_shot = true

[node name="SlashLeft" type="Area2D" parent="HitBoxHandler"]
position = Vector2(-2, 0)
scale = Vector2(1, 1.01132)
collision_layer = 0
collision_mask = 32

[node name="CollisionShape2D2" type="CollisionShape2D" parent="HitBoxHandler/SlashLeft"]
position = Vector2(-11, 0)
shape = SubResource("RectangleShape2D_esdid")
disabled = true

[node name="Timer" type="Timer" parent="HitBoxHandler/SlashLeft"]
one_shot = true

[node name="SlashRight" type="Area2D" parent="HitBoxHandler"]
position = Vector2(1, 0)
scale = Vector2(1, 1.01132)
collision_layer = 0
collision_mask = 32

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitBoxHandler/SlashRight"]
position = Vector2(12, 0)
shape = SubResource("RectangleShape2D_esdid")
disabled = true

[node name="Timer" type="Timer" parent="HitBoxHandler/SlashRight"]
one_shot = true

[node name="SlashUp" type="Area2D" parent="HitBoxHandler"]
position = Vector2(0, -84)
scale = Vector2(1, 1.01132)
collision_layer = 0
collision_mask = 32

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitBoxHandler/SlashUp"]
position = Vector2(0, 70.2053)
shape = SubResource("RectangleShape2D_qwpog")
disabled = true

[node name="Timer" type="Timer" parent="HitBoxHandler/SlashUp"]
one_shot = true

[node name="Navigation2DAgent" type="Node2D" parent="."]
scale = Vector2(122.225, 7.59879)
script = ExtResource("10_m80fk")
size = 2
endPathPointTolerance = 1
Capability = 4

[node name="Health" parent="." instance=ExtResource("10_1jhey")]
Max = 3
Value = 3
